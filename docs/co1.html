<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>çºªå¹´ |ã€ç¬¬å››æœŸã€‘æµ…æ co æºç  | ç‹å°å£®å£®</title>
    <meta name="description" content="A VitePress site">
    <link rel="preload stylesheet" href="/blog/assets/style.d16fa9ea.css" as="style">
    <script type="module" src="/blog/assets/app.df195c8e.js"></script>
    <link rel="modulepreload" href="/blog/assets/chunks/framework.984f5008.js">
    <link rel="modulepreload" href="/blog/assets/chunks/co0.740aa30f.js">
    <link rel="modulepreload" href="/blog/assets/docs_co1.md.e1abaeeb.lean.js">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta name="keywords" content="ç‹å°å£®å£®">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
  <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
  <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><!--[--><div id="containerColor" class="theme" data-v-8d54a449><header class="navbar" data-v-8d54a449><div data-v-8d54a449><div class="flex-grow"></div><nav class="nav-links hide-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/Friendship.html" target="" rel="">ğŸ‘« å‹æƒ…é“¾æ¥ <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--]--></div><div class="sidebar-button" data-v-8d54a449><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div></header><aside class="" data-v-8d54a449><!--[--><nav class="nav-links show-mobile"><!--[--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/index.html" target="" rel="">ğŸ  é¦–é¡µ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/docs.html" target="" rel="">ğŸ“… å½’æ¡£ <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/tags.html" target="" rel="">ğŸ“‚ åˆ†ç±» <!----></a></div><!--]--><!--[--><div class="nav-item"><a class="nav-link" href="/blog/more/Friendship.html" target="" rel="">ğŸ‘« å‹æƒ…é“¾æ¥ <!----></a></div><!--]--><!--]--><!----><!----></nav><!--[--><!--]--><ul class="sidebar"><!--[--><!--]--></ul><!--[--><!--]--><!--]--></aside><!----><div class="sidebar-mask" data-v-8d54a449></div><main data-v-8d54a449><!--[--><div class="content"><!--[--><!--]--><div class="md-header"><div class="md-title">çºªå¹´ |ã€ç¬¬å››æœŸã€‘æµ…æ co æºç </div><span id="jinrishici-sentence">æ­£åœ¨åŠ è½½ä»Šæ—¥è¯—è¯....</span><div class="md-date">2021-09-02T00:00:00.000Z</div></div><ul class="catalog"><!--[--><li class="catalog-item"><a class="level level-2" href="#_1-å‰è¨€">1. å‰è¨€</a><!----></li><li class="catalog-item"><a class="level level-2" href="#_2-ç®€å•äº†è§£-co">2. ç®€å•äº†è§£ co</a><!----></li><li class="catalog-item"><a class="level level-2" href="#_3-å­¦ä¹ ç›®æ ‡">3. å­¦ä¹ ç›®æ ‡</a><!----></li><li class="catalog-item"><a class="level level-2" href="#_4-è§£è¯»-co-æºç ">4. è§£è¯» co æºç </a><!----></li><li class="catalog-item"><a class="level level-2" href="#_5-å®è·µ">5. å®è·µ</a><!----></li><li class="catalog-item"><a class="level level-2" href="#_6-æ„Ÿæƒ³">6. æ„Ÿæƒ³</a><!----></li><!--]--></ul><div style="position:relative;"><div><blockquote><p>ã€è‹¥å·ã€‘æµ…æ koa æ´‹è‘±æ¨¡å‹å’Œ co åŸç†ï¼š<a href="https://juejin.cn/post/6844904088220467213" target="_blank" rel="noreferrer">https://juejin.cn/post/6844904088220467213</a></p><p>ã€æ˜æµ·Zzzzã€‘co æºç è§£æï¼š<a href="https://juejin.cn/post/6844903472362422286" target="_blank" rel="noreferrer">https://juejin.cn/post/6844903472362422286</a></p><p>ã€éªã€‘ co åº“æºç ï¼š<a href="https://www.yuque.com/ruochuan12/dxsvhs/pgzu2c" target="_blank" rel="noreferrer">https://www.yuque.com/ruochuan12/dxsvhs/pgzu2c</a></p></blockquote><h2 id="_1-å‰è¨€" tabindex="-1">1. å‰è¨€ <a class="header-anchor" href="#_1-å‰è¨€" aria-hidden="true">#</a></h2><p>è¿™å‘¨çœ‹çš„æ˜¯ co çš„æºç ï¼Œæˆ‘å¯¹ co æ¯”è¾ƒé™Œç”Ÿï¼Œæ²¡æœ‰äº†è§£å’Œä½¿ç”¨è¿‡ã€‚å› æ­¤åœ¨çœ‹æºç ä¹‹å‰ï¼Œæˆ‘å¸Œæœ›èƒ½å¤§æ¦‚äº†è§£ co æ˜¯ä»€ä¹ˆï¼Œè§£å†³äº†ä»€ä¹ˆé—®é¢˜ã€‚</p><h2 id="_2-ç®€å•äº†è§£-co" tabindex="-1">2. ç®€å•äº†è§£ co <a class="header-anchor" href="#_2-ç®€å•äº†è§£-co" aria-hidden="true">#</a></h2><p>å…ˆçœ‹äº† co çš„ <a href="https://github.com/tj/co" target="_blank" rel="noreferrer">GitHub</a>ï¼ŒREADME æ˜¯è¿™æ ·ä»‹ç»çš„ï¼š</p><blockquote><p>Generator based control flow goodness for nodejs and the browser, using promises, letting you write non-blocking code in a nice-ish way.</p></blockquote><p>çœ‹èµ·æ¥æœ‰ç‚¹æ‡µé€¼ï¼ŒåˆæŸ¥äº†ä¸€äº›èµ„æ–™ï¼Œå¤§å¤šè¯´ co æ˜¯ç”¨äº generator å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œã€‚generator æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä»¥æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œã€‚</p><h3 id="_2-1-å…³äº-generator" tabindex="-1">2.1 å…³äº generator <a class="header-anchor" href="#_2-1-å…³äº-generator" aria-hidden="true">#</a></h3><p>è¯´åˆ°å¼‚æ­¥ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°è¿˜æœ‰ promiseï¼Œasync å’Œ awaitã€‚å®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿå…ˆçœ‹çœ‹ JS å¼‚æ­¥ç¼–ç¨‹è¿›åŒ–å²ï¼šcallback -&gt; promise -&gt; generator -&gt; async + await</p><p><img src="/blog/assets/co0.41239ac1.png" alt="JS å¼‚æ­¥ç¼–ç¨‹"></p><p>å†çœ‹çœ‹å®ƒä»¬è¯­æ³•ä¸Šçš„å·®å¼‚ï¼š</p><table await="" fetchData()=""><thead><tr><th>Callback</th><th>Promise</th><th>Generator</th><th>async + await + Promise</th></tr></thead><tbody><tr><td>ajax(url, () =&gt; {})</td><td>Promise((resolve,reject) =&gt; { resolve() }).then()</td><td yield="" 1="">function* gen()</td><td>async getData()</td></tr></tbody></table><blockquote><p>å…³äº generator çš„å­¦ä¹ ä¸åœ¨æ­¤ç¯‡å¹…è¯¦å†™äº†ï¼Œéœ€è¦äº†è§£å®ƒçš„æ¦‚å¿µå’Œè¯­æ³•ã€‚</p></blockquote><h2 id="_3-å­¦ä¹ ç›®æ ‡" tabindex="-1">3. å­¦ä¹ ç›®æ ‡ <a class="header-anchor" href="#_3-å­¦ä¹ ç›®æ ‡" aria-hidden="true">#</a></h2><p>ç»è¿‡ç®€å•å­¦ä¹ ï¼Œå¤§æ¦‚æ˜ç™½äº† co äº§ç”Ÿçš„èƒŒæ™¯ï¼Œå› ä¸º generator å‡½æ•°ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œéœ€è¦æ‰‹åŠ¨è°ƒç”¨å®ƒçš„ next() å‡½æ•°ï¼Œco çš„ä½œç”¨å°±æ˜¯è‡ªåŠ¨æ‰§è¡Œ generator çš„ next() å‡½æ•°ï¼Œç›´åˆ° done çš„çŠ¶æ€å˜æˆ true ä¸ºæ­¢ã€‚</p><p>é‚£ä¹ˆæˆ‘è¿™ä¸€æœŸçš„å­¦ä¹ ç›®æ ‡ï¼š</p><p>1ï¼‰è§£è¯» co æºç ï¼Œç†è§£å®ƒæ˜¯å¦‚ä½•å®ç°è‡ªåŠ¨æ‰§è¡Œ generator</p><p>2ï¼‰åŠ¨æ‰‹å®ç°ä¸€ä¸ªç®€ç•¥ç‰ˆçš„ co</p><h2 id="_4-è§£è¯»-co-æºç " tabindex="-1">4. è§£è¯» co æºç  <a class="header-anchor" href="#_4-è§£è¯»-co-æºç " aria-hidden="true">#</a></h2><p>co æºç åœ°å€ï¼š<a href="https://github.com/tj/co" target="_blank" rel="noreferrer">https://github.com/tj/co</a></p><h3 id="_4-1-æ•´ä½“æ¶æ„" tabindex="-1">4.1 æ•´ä½“æ¶æ„ <a class="header-anchor" href="#_4-1-æ•´ä½“æ¶æ„" aria-hidden="true">#</a></h3><p>ä» README ä¸­ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯å¦‚ä½•ä½¿ç”¨ co ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">co</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">value</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">stack</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>ä»ä»£ç å¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶äº†ä¸€ä¸ª generator å‡½æ•°ï¼Œè¿”å›äº†ä¸€ä¸ª Promiseï¼Œè¿™éƒ¨åˆ†å¯¹åº”çš„æºç å¦‚ä¸‹ã€‚</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">co</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">gen</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ctx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// è·å–å‚æ•°</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">slice</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">arguments</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// è¿”å›ä¸€ä¸ª Promise</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#F07178;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æŠŠ ctx å’Œå‚æ•°ä¼ é€’ç»™ gen å‡½æ•°</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#A6ACCD;">gen</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">apply</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­ gen.next æ˜¯å¦å‡½æ•°ï¼Œå¦‚æœä¸æ˜¯ç›´æ¥ resolve(gen)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">gen</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">next</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">gen</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å…ˆæ‰§è¡Œä¸€æ¬¡ next</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å®é™…ä¸Šå°±æ˜¯æ‰§è¡Œ gen.next å‡½æ•°ï¼Œè·å– gen çš„å€¼</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">ret</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ret</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¯¹ gen.throw çš„å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onRejected</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">ret</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">throw</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ret</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å®é™…å¤„ç†çš„å‡½æ•°ï¼Œä¼šé€’å½’æ‰§è¡Œï¼Œç›´åˆ° ret.done çŠ¶æ€ä¸º true</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">ret</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å¦‚æœç”Ÿæˆå™¨çš„çŠ¶æ€ done ä¸º trueï¼Œå°± resolve(ret.value)ï¼Œè¿”å›ç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">done</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å¦åˆ™ï¼Œå°† gen çš„ç»“æœ value å°è£…æˆ Promise</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">toPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­ value æ˜¯å¦ Promiseï¼Œå¦‚æœæ˜¯å°±è¿”å› then</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">isPromise</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">onFulfilled</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">onRejected</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// å¦‚æœä¸æ˜¯ Promiseï¼ŒRejected</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onRejected</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">TypeError</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">You may only yield a function, promise, generator, array, or object, </span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">but the following object was passed: &quot;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">String</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&quot;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>çœ‹åˆ°è¿™é‡Œï¼Œæˆ‘äº§ç”Ÿäº†ä¸€ä¸ªç–‘é—®ï¼šPromise + then ä¹Ÿå¯ä»¥å¤„ç†å¼‚æ­¥ç¼–ç¨‹ï¼Œä¸ºä»€ä¹ˆ co çš„æºç é‡Œè¦æŠŠ Promise + generator ç»“åˆèµ·æ¥å‘¢ï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿç›´åˆ°æˆ‘ææ‡‚äº† co çš„æ ¸å¿ƒç›®çš„ï¼Œå®ƒä½¿ generator å’Œ yield çš„è¯­æ³•æ›´è¶‹å‘äºåŒæ­¥ç¼–ç¨‹çš„å†™æ³•ï¼Œå¼•ç”¨<a href="https://www.ruanyifeng.com/blog/2015/04/generator.html" target="_blank" rel="noreferrer">é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a>ä¸­çš„ä¸€å¥è¯å°±æ˜¯ï¼š</p><blockquote><p>å¼‚æ­¥ç¼–ç¨‹çš„è¯­æ³•ç›®æ ‡ï¼Œå°±æ˜¯æ€æ ·è®©å®ƒæ›´åƒåŒæ­¥ç¼–ç¨‹ã€‚</p></blockquote><p>å¯ä»¥çœ‹ä¸€ä¸ª Promise + then çš„ä¾‹å­ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getData</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#F07178;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1111</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#82AAFF;">getData</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¤„ç†ç¬¬ä¸€ä¸ªå¼‚æ­¥çš„ç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// è¿”å›ç¬¬äºŒä¸ªå¼‚æ­¥</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2222</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¤„ç†ç¬¬äºŒä¸ªå¼‚æ­¥çš„ç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>å¦‚æœæœ‰å¤šä¸ªå¼‚æ­¥å¤„ç†å°±ä¼šéœ€è¦å†™å¤šå°‘ä¸ª then æ¥å¤„ç†å¼‚æ­¥ä¹‹é—´å¯èƒ½å­˜åœ¨çš„åŒæ­¥å…³ç³»ï¼Œä»ä»¥ä¸Šçš„ä»£ç å¯ä»¥çœ‹åˆ° then çš„å¤„ç†æ˜¯ä¸€å±‚ä¸€å±‚çš„åµŒå¥—ã€‚å¦‚æœæ¢æˆ coï¼Œåœ¨å†™æ³•ä¸Šæ›´ä¼˜é›…ä¹Ÿ<strong>æ›´ç¬¦åˆæ—¥å¸¸åŒæ­¥ç¼–ç¨‹</strong>çš„å†™æ³•ï¼š</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">co</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result1</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">1111</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¤„ç†ç¬¬ä¸€ä¸ªå¼‚æ­¥çš„ç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// è¿”å›ç¬¬äºŒä¸ªå¼‚æ­¥</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result2</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">2222</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// å¤„ç†ç¬¬äºŒä¸ªå¼‚æ­¥çš„ç»“æœ</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result2</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="_4-2-åˆ†æ-next-å‡½æ•°" tabindex="-1">4.2 åˆ†æ next å‡½æ•° <a class="header-anchor" href="#_4-2-åˆ†æ-next-å‡½æ•°" aria-hidden="true">#</a></h3><p>æºç çš„ next å‡½æ•°æ¥æ”¶ä¸€ä¸ª gen.next() è¿”å›çš„å¯¹è±¡ ret ä½œä¸ºå‚æ•°ï¼Œå½¢å¦‚<code>{value: T, done: boolean}</code>ï¼Œnext å‡½æ•°åªæœ‰å››è¡Œä»£ç ã€‚</p><p>ç¬¬ä¸€è¡Œï¼š<code>if (ret.done) return resolve(ret.value);</code> å¦‚æœ ret.done ä¸º trueï¼Œè¡¨æ˜ gen å‡½æ•°åˆ°äº†ç»“æŸçŠ¶æ€ï¼Œå°± resolve(ret.value)ï¼Œè¿”å›ç»“æœã€‚</p><p>ç¬¬äºŒè¡Œï¼š<code>var value = toPromise.call(ctx, ret.value);</code> è°ƒç”¨ toPromise.call(ctx, ret.value) å‡½æ•°ï¼ŒtoPromise å‡½æ•°çš„ä½œç”¨æ˜¯æŠŠ ret.value è½¬åŒ–æˆ Promise ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ç”¨ Promise åŒ…è£¹ä¸€å±‚å† return å‡ºå»ã€‚</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">toPromise</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">obj</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ obj ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å› obj</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ obj æ˜¯ Promise ç±»å‹ï¼Œç›´æ¥è¿”å› obj</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#82AAFF;">isPromise</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ obj æ˜¯ç”Ÿæˆå™¨å‡½æ•°æˆ–éå†å™¨å¯¹è±¡, å°±é€’å½’è°ƒç”¨ co å‡½æ•°</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#82AAFF;">isGeneratorFunction</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">isGenerator</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">co</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ obj æ˜¯æ™®é€šçš„å‡½æ•°ç±»å‹ï¼Œè½¬æ¢æˆ Promise ç±»å‹å‡½æ•°å†è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">function</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">typeof</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">thunkToPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ obj æ˜¯ä¸€ä¸ªæ•°ç»„, è½¬æ¢æˆ Promise æ•°ç»„å†è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">Array</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">isArray</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">arrayToPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å¦‚æœ obj æ˜¯ä¸€ä¸ªå¯¹è±¡, è½¬æ¢æˆ Promise å¯¹è±¡å†è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#82AAFF;">isObject</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">objectToPromise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// å…¶ä»–æƒ…å†µç›´æ¥è¿”å›</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">obj</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>ç¬¬ä¸‰è¡Œï¼š<code>if (value &amp;&amp; isPromise(value)) return value.then(onFulfilled, onRejected);</code> å¦‚æœ value æ˜¯ Promise ç±»å‹ï¼Œè°ƒç”¨ onFulfilled æˆ– onRejectedï¼Œå®é™…ä¸Šæ˜¯é€’å½’è°ƒç”¨äº† next å‡½æ•°æœ¬èº«ï¼Œç›´åˆ° done çŠ¶æ€ä¸º true æˆ– throw errorã€‚</p><p>ç¬¬å››è¡Œï¼š<code>return onRejected(...)</code> å¦‚æœä¸æ˜¯ Promiseï¼Œç›´æ¥ Rejectedã€‚</p><h2 id="_5-å®è·µ" tabindex="-1">5. å®è·µ <a class="header-anchor" href="#_5-å®è·µ" aria-hidden="true">#</a></h2><p>è™½ç„¶è§£è¯»äº† co çš„æ ¸å¿ƒä»£ç ï¼Œçœ‹èµ·æ¥åƒæ˜¯æ‡‚äº†ï¼Œå®é™…ä¸Šå¾ˆå®¹æ˜“é—å¿˜ã€‚ä¸ºäº†åŠ æ·±ç†è§£ï¼Œç»“åˆä¸Šé¢çš„ co æºç å’Œè‡ªå·±çš„æ€è·¯åŠ¨æ‰‹å®ç°ä¸€ä¸ªç®€ç•¥ç‰ˆçš„ coã€‚</p><h3 id="_5-1-æ¨¡æ‹Ÿè¯·æ±‚" tabindex="-1">5.1 æ¨¡æ‹Ÿè¯·æ±‚ <a class="header-anchor" href="#_5-1-æ¨¡æ‹Ÿè¯·æ±‚" aria-hidden="true">#</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">request</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">resolve</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">setTimeout</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">},</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ç”¨ yield è·å– request çš„å€¼</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getData</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">request</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> g </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getData</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> done</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> g</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// é—´éš”1såæ‰“å° {data: &quot;request&quot;}</span></span>
<span class="line"><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(res))</span></span>
<span class="line"></span></code></pre></div><h3 id="_5-2-æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ-co" tabindex="-1">5.2 æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ co <a class="header-anchor" href="#_5-2-æ¨¡æ‹Ÿå®ç°ç®€ç‰ˆ-co" aria-hidden="true">#</a></h3><p>æ ¸å¿ƒå®ç°ï¼š</p><p>1ï¼‰å‡½æ•°ä¼ å‚</p><p>2ï¼‰generator.next è‡ªåŠ¨æ‰§è¡Œ</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">co</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">gen</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 1. ä¼ å‚</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ctx</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Array</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">prototype</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">slice</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">call</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">arguments</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">gen</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">apply</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#F07178;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;font-style:italic;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 2. è‡ªåŠ¨æ‰§è¡Œ next</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">onFulfilled</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ret</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">gen</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ret</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">next</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">ret</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">done</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// æ­¤å¤„åªå¤„ç† ret.value æ˜¯ Promise å¯¹è±¡çš„æƒ…å†µï¼Œå…¶ä»–ç±»å‹ç®€ç•¥ç‰ˆæ²¡å¤„ç†</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">promise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ret</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">value</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">// è‡ªåŠ¨æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">promise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">onFulfilled</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#82AAFF;">co</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getData</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">request</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 1såæ‰“å° {data: &quot;request&quot;}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="_6-æ„Ÿæƒ³" tabindex="-1">6. æ„Ÿæƒ³ <a class="header-anchor" href="#_6-æ„Ÿæƒ³" aria-hidden="true">#</a></h2><p>å¯¹æˆ‘æ¥è¯´ï¼Œå­¦ä¹ ä¸€ä¸ªæ–°çš„ä¸œè¥¿ï¼ˆgeneratorï¼‰èŠ±è´¹çš„æ—¶é—´è¿œè¿œå¤§äºå•çº¯é˜…è¯»æºç çš„æ—¶é—´ï¼Œå› ä¸ºéœ€è¦äº†è§£å®ƒäº§ç”Ÿçš„èƒŒæ™¯ï¼Œè¯­æ³•ï¼Œè§£å†³çš„é—®é¢˜ä»¥åŠä¸€äº›åº”ç”¨åœºæ™¯ï¼Œè¿™æ ·åœ¨é˜…è¯»æºç çš„æ—¶å€™æ‰çŸ¥é“å®ƒä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ã€‚</p><p>è¯»å®Œæºç ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œå…¶å® co å°±æ˜¯ä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œ next() çš„å‡½æ•°ï¼Œè€Œä¸”åˆ°æœ€åæˆ‘ä»¬ä¼šå‘ç° co çš„å†™æ³•å’Œæˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„ async/await çš„å†™æ³•éå¸¸ç›¸åƒï¼Œå› æ­¤ä¹Ÿä¸éš¾ç†è§£ã€async/await å®é™…ä¸Šæ˜¯å¯¹ generator å°è£…çš„ä¸€ä¸ªè¯­æ³•ç³–ã€‘è¿™å¥è¯äº†ã€‚</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#676E95;font-style:italic;">// co å†™æ³•</span></span>
<span class="line"><span style="color:#82AAFF;">co</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getData</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">yield</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">request</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 1såæ‰“å° {data: &quot;request&quot;}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// async await å†™æ³•</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getData</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">var</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">request</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 1såæ‰“å° {data: &quot;request&quot;}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">result</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)()</span></span>
<span class="line"></span></code></pre></div><p>ä¸å¾—ä¸è¯´ï¼Œé˜…è¯»æºç çš„ç¡®æ˜¯ä¸€ä¸ªå¼€é˜”è§†é‡çš„å¥½æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯è¿™æ¬¡æ´»åŠ¨ï¼Œæˆ‘å¯èƒ½è¿˜è¦æ™šä¸ªå¤§åŠå¹´æ‰æ¥è§¦åˆ° generatorï¼Œæ¥è§¦åç¨‹çš„æ¦‚å¿µï¼Œäº†è§£åˆ° async/await å®ç°çš„åŸç†ï¼Œå¸Œæœ›èƒ½å¤Ÿç»§ç»­åšæŒä¸‹å»~</p><div id="gitalk-container"></div></div></div><div class="links-wrapper"><div class="prev-link"><!----></div><div class="next-link"><!----></div></div><div><footer class="page-edit"><!--[--><a href="https://juejin.cn/user/3175045313607534"><img class="imgIcon" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC"></a><!--]--></footer><p class="platform"> ä»¥ä¸Šçš†ä¸º <a href="javascript:;">ç‹å°å£®å£®</a> æ–‡ç« å‘å¸ƒå¹³å° </p><p class="platform"> Copyright Â© 2023-2099 <a href="https://github.com/jexlau">@wdl</a></p></div><!--[--><!--]--></div><div style="display:none;" class="imgBox"><img src=""></div><!--]--></main><div class="theme-select" data-v-8d54a449><ul data-v-8d54a449><li class="active" data-v-8d54a449>â˜€ï¸</li><li class="" data-v-8d54a449>ğŸŒ‘</li></ul></div></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"docs_co.md\":\"b3985908\",\"readme.md\":\"305e69a5\",\"more_index.md\":\"3c4389c0\",\"index.md\":\"f5191847\",\"more_docs.md\":\"a58c2632\",\"more_friendship.md\":\"58f4e050\",\"more_tags.md\":\"3b03880e\",\"docs_vue3-release.md\":\"2d8cfcb2\",\"docs_launch-editor.md\":\"4e0a53ad\",\"docs_co1.md\":\"e1abaeeb\",\"docs_co2.md\":\"75f80d0e\",\"docs_vue3-utils.md\":\"70936fb8\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"ç‹å°å£®å£®\",\"description\":\"A VitePress site\",\"base\":\"/blog/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"displayAllHeaders\":true,\"logo\":\"/favicon.ico\",\"pages\":[{\"frontMatter\":{\"date\":\"2023-03-13\",\"title\":\"ç‹å°å£®å£® |ã€ç¬¬ä¸€æœŸã€‘ç¬¬ä¸€æ¬¡æ­å»ºåšå®¢è®°å½•\",\"tags\":[\"è®°å½•\",\"æ³¨æ„äº‹é¡¹\"],\"describe\":\"ç¬¬ä¸€æ¬¡æ­å»ºåšå®¢è®°å½•\"},\"regularPath\":\"/docs/co.html\",\"relativePath\":\"docs/co.md\"},{\"frontMatter\":{\"date\":\"2021-09-02\",\"title\":\"çºªå¹´ |ã€ç¬¬å››æœŸã€‘æµ…æ co æºç \",\"tags\":[\"æºç \",\"Promise\"],\"describe\":\"æµ…æ co æºç \"},\"regularPath\":\"/docs/co2.html\",\"relativePath\":\"docs/co2.md\"},{\"frontMatter\":{\"date\":\"2021-09-02\",\"title\":\"çºªå¹´ |ã€ç¬¬å››æœŸã€‘æµ…æ co æºç \",\"tags\":[\"æºç \",\"Promise\"],\"describe\":\"æµ…æ co æºç \"},\"regularPath\":\"/docs/co1.html\",\"relativePath\":\"docs/co1.md\"},{\"frontMatter\":{\"date\":\"2021-08-25\",\"title\":\"çºªå¹´ |ã€ç¬¬ä¸‰æœŸã€‘Vue3 Release æºç è§£è¯»è®°å½•\",\"tags\":[\"æºç \",\"vue3\"],\"describe\":\"Vue3 Release æºç è§£è¯»\"},\"regularPath\":\"/docs/vue3-release.html\",\"relativePath\":\"docs/vue3-release.md\"},{\"frontMatter\":{\"date\":\"2021-08-18\",\"title\":\"çºªå¹´ |ã€ç¬¬äºŒæœŸã€‘Vue3 æºç ä¸­çš„åŸºç¡€å·¥å…·å‡½æ•°\",\"tags\":[\"æºç \",\"vue3\"],\"describe\":\"Vue3 ä¸­çš„å·¥å…·å‡½æ•°æºç è§£è¯»è®°å½•\"},\"regularPath\":\"/docs/vue3-utils.html\",\"relativePath\":\"docs/vue3-utils.md\"},{\"frontMatter\":{\"date\":\"2021-08-11\",\"title\":\"çºªå¹´ |ã€ç¬¬ä¸€æœŸã€‘launch-editor æºç è§£è¯»è®°å½•\",\"tags\":[\"æºç \",\"vue3\"],\"describe\":\"launch-editor æºç è§£è¯»è®°å½•\"},\"regularPath\":\"/docs/launch-editor.html\",\"relativePath\":\"docs/launch-editor.md\"}],\"author\":\"ç‹å°å£®å£®\",\"search\":true,\"nav\":[{\"text\":\"ğŸ  é¦–é¡µ\",\"link\":\"/index\"},{\"text\":\"ğŸ“… å½’æ¡£\",\"link\":\"/more/docs\"},{\"text\":\"ğŸ“‚ åˆ†ç±»\",\"link\":\"/more/tags\"},{\"text\":\"ğŸ‘« å‹æƒ…é“¾æ¥\",\"link\":\"/more/Friendship\"}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>